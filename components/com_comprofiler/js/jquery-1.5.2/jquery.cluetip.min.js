/*!
 * jQuery clueTip plugin v1.1.3
 *
 * Date: Mon Apr 11 20:31:15 2011 EDT
 * Requires: jQuery v1.3+
 *
 * Copyright 2011, Karl Swedberg
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * Full list of options/settings can be found at the bottom of this file and at http://plugins.learningjquery.com/cluetip/
 * Examples can be found at http://plugins.learningjquery.com/cluetip/demo/
 *
*/(function(a){a.cluetip={version:"1.1.3",setup:{insertionType:"appendTo",insertionElement:"body"},defaults:{width:275,height:"auto",cluezIndex:97,positionBy:"auto",topOffset:15,leftOffset:15,local:!1,localPrefix:null,localIdSuffix:null,hideLocal:!0,attribute:"rel",titleAttribute:"title",splitTitle:"",escapeTitle:!1,showTitle:!0,cluetipClass:"default",hoverClass:"",waitImage:!0,cursor:"help",arrows:!1,dropShadow:!0,dropShadowSteps:6,sticky:!1,mouseOutClose:!1,activation:"hover",clickThrough:!0,tracking:!1,delayedClose:0,closePosition:"top",closeText:"Close",truncate:0,fx:{open:"show",openSpeed:""},hoverIntent:{sensitivity:3,interval:50,timeout:0},onActivate:function(a){return!0},onShow:function(a,b){},onHide:function(a,b){},ajaxCache:!0,ajaxProcess:function(a){a=a.replace(/<(script|style|title)[^<]+<\/(script|style|title)>/gm,"").replace(/<(link|meta)[^>]+>/g,"");return a},ajaxSettings:{dataType:"html"},debug:!1}};var b,c,d,e,f,g,h,i,j="ui-widget ui-widget-content ui-cluetip";a.fn.cluetip=function(k,l){function q(b,c){var d=b.dropShadow&&b.dropShadowSteps?+b.dropShadowSteps:0;if(a.support.boxShadow){var e=d===0?"0 0 ":"1px 1px ";a("#cluetip").css(a.support.boxShadow,e+d+"px rgba(0,0,0,0.5)");return!1}var f=a("#cluetip .cluetip-drop-shadow");if(d==f.length)return f;f.remove();var g=[];for(var h=0;h<d;)g[h++]='<div style="top:'+h+"px;left:"+h+'px;"></div>';c=a(g.join("")).css({position:"absolute",backgroundColor:"#000",zIndex:o-1,opacity:.1}).addClass("cluetip-drop-shadow").prependTo("#cluetip");return c}typeof k=="object"&&(l=k,k=null);if(k=="destroy"){a(document).unbind(".cluetip"),a("#cluetip").remove(),a.removeData(this,"title"),a.removeData(this,"cluetip");return this.unbind(".cluetip")}l=a.extend(!0,{},a.cluetip.defaults,l||{});var m=/appendTo|prependTo|insertBefore|insertAfter/.test(l.insertionType)?l.insertionType:"appendTo",n=l.insertionElement||"body";if(!a("#cluetip").length){a(['<div id="cluetip">','<div id="cluetip-outer" class="ui-cluetip-outer">','<h3 id="cluetip-title" class="ui-widget-header ui-cluetip-header"></h3>','<div id="cluetip-inner" class="ui-widget-content ui-cluetip-content"></div>',"</div>",'<div id="cluetip-extra"></div>','<div id="cluetip-arrows" class="cluetip-arrows"></div>',"</div>"].join(""))[m](n).hide();var o=+l.cluezIndex;b=a("#cluetip").css({position:"absolute"}),d=a("#cluetip-outer").css({position:"relative",zIndex:o}),c=a("#cluetip-inner"),e=a("#cluetip-title"),f=a("#cluetip-arrows"),g=a('<div id="cluetip-waitimage"></div>').css({position:"absolute"}).insertBefore(b).hide()}var p=(parseInt(b.css("paddingLeft"),10)||0)+(parseInt(b.css("paddingRight"),10)||0);this.each(function(m){function U(){return!1}var n=this,r=a(this),s=a.extend(!0,{},l,a.metadata?r.metadata():a.meta?r.data():{}),t=!1,u=!1,v=0,w=r.attr(s.attribute),x=s.cluetipClass;o=+s.cluezIndex,r.data("cluetip",{title:n.title,zIndex:o});if(!w&&!s.splitTitle&&!k)return!0;s.local&&s.localPrefix&&(w=s.localPrefix+w),s.local&&s.hideLocal&&w&&a(w+":first").hide();var y=parseInt(s.topOffset,10),z=parseInt(s.leftOffset,10),A,B,C=isNaN(parseInt(s.height,10))?"auto":/\D/g.test(s.height)?s.height:s.height+"px",D,E,F,G,H,I,J=parseInt(s.width,10)||275,K=J+p+s.dropShadowSteps,L=this.offsetWidth,M,N,O,P,Q,R,S=s.attribute!="title"?r.attr(s.titleAttribute):"";s.splitTitle&&(S==undefined&&(S=""),R=S.split(s.splitTitle),S=R.shift()),s.escapeTitle&&(S=S.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;"));var T,V=function(e){var h=s.onActivate(r);if(h===!1)return!1;u=!0,b.removeClass().css({width:J}),w==r.attr("href")&&r.css("cursor",s.cursor),s.hoverClass&&r.addClass(s.hoverClass),E=F=r.offset().top,M=r.offset().left,L=r.innerWidth(),e.type==focus?(P=M+L/2+z,b.css({left:N}),H=F+y):(P=e.pageX,H=e.pageY),n.tagName.toLowerCase()!="area"&&(D=a(document).scrollTop(),Q=a(window).width());if(s.positionBy=="fixed")N=L+M+z,b.css({left:N});else{N=L>M&&M>K||M+L+K+z>Q?M-K-z:L+M+z;if(n.tagName.toLowerCase()=="area"||s.positionBy=="mouse"||L+K>Q)P+20+K>Q?(b.addClass(" cluetip-"+x),N=P-K-z>=0?P-K-z-parseInt(b.css("marginLeft"),10)+parseInt(c.css("marginRight"),10):P-K/2):N=P+z;var j=N<0?e.pageY+y:e.pageY;b.css({left:N>0&&s.positionBy!="bottomTop"?N:P+K/2>Q?Q/2-K/2:Math.max(P-K/2,0),zIndex:r.data("cluetip").zIndex}),f.css({zIndex:r.data("cluetip").zIndex+1})}B=a(window).height();if(k)typeof k=="function"&&(k=k.call(n)),c.html(k),W(j);else if(R){var l=R.length;c.html(l?R[0]:"");if(l>1)for(var o=1;o<l;o++)c.append('<div class="split-body">'+R[o]+"</div>");W(j)}else if(s.local||w.indexOf("#")===0){if(s.local){var I=a(w+(/#\S+$/.test(w)?"":":eq("+m+")")).clone(!0).show();s.localIdSuffix&&I.attr("id",I[0].id+s.localIdSuffix),c.html(I),W(j)}}else if(/\.(jpe?g|tiff?|gif|png)(?:\?.*)?$/i.test(w))c.html('<img src="'+w+'" alt="'+S+'" />'),W(j);else{var p=s.ajaxSettings.beforeSend,q=s.ajaxSettings.error,v=s.ajaxSettings.success,A=s.ajaxSettings.complete,C={cache:s.ajaxCache,url:w,beforeSend:function(a){p&&p.call(n,a,b,c),d.children().empty(),s.waitImage&&g.css({top:H+20,left:P+20,zIndex:r.data("cluetip").zIndex-1}).show()},error:function(a,d){u&&(q?q.call(n,a,d,b,c):c.html("<i>sorry, the contents could not be loaded</i>"))},success:function(a,d){t=s.ajaxProcess.call(n,a),u&&(v&&v.call(n,a,d,b,c),c.html(t))},complete:function(d,e){A&&A.call(n,d,e,b,c);var f=c[0].getElementsByTagName("img");i=f.length;for(var h=0,k=f.length;h<k;h++)f[h].complete&&i--;i&&!a.browser.opera?a(f).bind("load error",function(){i--,i<1&&(g.hide(),u&&W(j))}):(g.hide(),u&&W(j))}},G=a.extend(!0,{},s.ajaxSettings,C);a.ajax(G)}},W=function(g){function k(){}b.addClass("cluetip-"+x);if(s.truncate){var i=c.text().slice(0,s.truncate)+"...";c.html(i)}S?e.show().html(S):s.showTitle?e.show().html("&nbsp;"):e.hide();if(s.sticky){var l=a('<div id="cluetip-close"><a href="#">'+s.closeText+"</a></div>");s.closePosition=="bottom"?l.appendTo(c):s.closePosition=="title"?l.prependTo(e):l.prependTo(c),l.bind("click.cluetip",function(){Y();return!1}),s.mouseOutClose?b.bind("mouseleave.cluetip",function(){Y()}):b.unbind("mouseleave.cluetip")}var m="";d.css({zIndex:r.data("cluetip").zIndex,overflow:C=="auto"?"visible":"auto",height:C}),A=C=="auto"?Math.max(b.outerHeight(),b.height()):parseInt(C,10),G=F,I=D+B,s.positionBy=="fixed"?G=F-s.dropShadowSteps+y:N<P&&Math.max(N,0)+K>P||s.positionBy=="bottomTop"?F+A+y>I&&H-D>A+y?(G=H-A-y,m="top"):(G=H+y,m="bottom"):F+A+y>I?G=A>=B?D:I-A-y:r.css("display")=="block"||n.tagName.toLowerCase()=="area"||s.positionBy=="mouse"?G=g-y:G=F-s.dropShadowSteps,m==""&&(N<M?m="left":m="right");var o=" clue-"+m+"-"+x+" cluetip-"+x;x=="rounded"&&(o+=" ui-corner-all"),b.css({top:G+"px"}).attr({className:j+o});if(s.arrows){var p=F-G-s.dropShadowSteps;f.css({top:/(left|right)/.test(m)&&N>=0&&p>0?p+"px":/(left|right)/.test(m)?0:""}).show()}else f.hide();h=q(s),h&&h.length&&h.hide().css({height:A,width:J,zIndex:r.data("cluetip").zIndex-1}).show(),b.hide()[s.fx.open](s.fx.openSpeed||0),a.fn.bgiframe&&b.bgiframe(),s.delayedClose>0&&(v=setTimeout(Y,s.delayedClose)),s.onShow.call(n,b,c)},X=function(a){u=!1,g.hide();if(!s.sticky||/click|toggle/.test(s.activation))Y(),clearTimeout(v);s.hoverClass&&r.removeClass(s.hoverClass)},Y=function(){d.parent().hide().removeClass(),s.onHide.call(n,b,c),r.removeClass("cluetip-clicked"),S&&r.attr(s.titleAttribute,S),r.css("cursor",""),s.arrows&&f.css({top:""})};a(document).bind("hideCluetip",function(a){Y()});if(/click|toggle/.test(s.activation))r.bind("click.cluetip",function(c){b.is(":hidden")||!r.is(".cluetip-clicked")?(V(c),a(".cluetip-clicked").removeClass("cluetip-clicked"),r.addClass("cluetip-clicked")):X(c);return!1});else if(s.activation=="focus")r.bind("focus.cluetip",function(a){r.attr("title",""),V(a)}),r.bind("blur.cluetip",function(a){r.attr("title",r.data("cluetip").title),X(a)});else{r[s.clickThrough?"unbind":"bind"]("click.cluetip",U);var Z=function(a){if(s.tracking==!0){var c=N-a.pageX,d=G?G-a.pageY:F-a.pageY;r.bind("mousemove.cluetip",function(a){b.css({left:a.pageX+c,top:a.pageY+d})})}};a.fn.hoverIntent&&s.hoverIntent?r.hoverIntent({sensitivity:s.hoverIntent.sensitivity,interval:s.hoverIntent.interval,over:function(a){V(a),Z(a)},timeout:s.hoverIntent.timeout,out:function(a){X(a),r.unbind("mousemove.cluetip")}}):r.bind("mouseenter.cluetip",function(a){V(a),Z(a)}).bind("mouseleave.cluetip",function(a){X(a),r.unbind("mousemove.cluetip")}),r.bind("mouseover.cluetip",function(a){r.attr("title","")}).bind("mouseleave.cluetip",function(a){r.attr("title",r.data("cluetip").title)})}});return this},function(){a.support=a.support||{};var b=document.createElement("div"),c=b.style,d=["boxShadow"],e=["moz","Moz","webkit","o"];for(var f=0,g=d.length;f<g;f++){var h=d[f],i=h.charAt(0).toUpperCase()+h.slice(1);if(typeof c[h]!=="undefined")a.support[h]=h;else for(var j=0,k=e.length;j<k;j++)if(typeof c[e[j]+i]!=="undefined"){a.support[h]=e[j]+i;break}}b=null}(),a.fn.cluetip.defaults=a.cluetip.defaults})(jQuery)